---
# Kayobe Kolla configuration.

###############################################################################
# Kolla installation.

# Type of Kolla control installation. One of 'binary' or 'source'.
#kolla_ctl_install_type: source

# Path to directory for kolla source code checkout.
#kolla_source_path:

# URL of Kolla source code repository if type is 'source'.
kolla_source_url: https://github.com/RSE-Cambridge/kolla

# Version (branch, tag, etc.) of Kolla source code repository if type is
# 'source'.
kolla_source_version: refs/tags/cumulus/7.0.1.2

# Path to virtualenv in which to install kolla.
#kolla_venv:

# Path in which to generate kolla configuration.
#kolla_build_config_path:

###############################################################################
# Kolla-ansible installation.

# Type of Kolla-ansible control installation. One of 'binary' or 'source'.
kolla_ansible_ctl_install_type: source

# Path to directory for kolla-ansible source code checkout.
#kolla_ansible_source_path:

# URL of Kolla Ansible source code repository if type is 'source'.
kolla_ansible_source_url: https://github.com/RSE-Cambridge/kolla-ansible

# Version (branch, tag, etc.) of Kolla Ansible source code repository if type
# is 'source'.
kolla_ansible_source_version: refs/tags/cumulus/7.0.1.2

# Path to virtualenv in which to install kolla-ansible.
#kolla_ansible_venv:

# Extra requirements to install inside the kolla-ansible virtualenv.
#kolla_ansible_venv_extra_requirements:

# Path to Kolla-ansible configuration directory.
#kolla_config_path:

# Path to Kolla-ansible node custom configuration directory.
#kolla_node_custom_config_path:

###############################################################################
# Kolla configuration.

# Kolla base container image distribution.
#kolla_base_distro:

# Kolla installation type: binary or source.
#kolla_install_type:

# URL of docker registry to use for Kolla images.
kolla_docker_registry: "{{ docker_registry }}"

# Docker namespace to use for Kolla images.
kolla_docker_namespace: rse-cambridge

# Username to use to access a docker registry.
#kolla_docker_registry_username:

# Password to use to access a docker registry.
#kolla_docker_registry_password:

# Kolla OpenStack release version. This should be a Docker image tag.
kolla_openstack_release: 7.0.1.2

# Dict mapping names of sources to their definitions for
# kolla_install_type=source. See kolla.common.config for details.
# Example:
# kolla_sources:
#   ironic_base:
#     type: git
#     location: https://github.com/openstack/ironic
#     reference: master
#kolla_sources:

###############################################################################
# Kolla image build configuration.

# Dict mapping Jinja2 block names in kolla's Docker images to their contents.
#kolla_build_blocks:
kolla_build_blocks:
  ironic_inspector_footer: |
    # Install our custom inspector plugins.
    RUN pip install stackhpc-inspector-plugins==1.1.1
  manila_share_footer: |
    # Update the ceph volume client to mimic, due to obsolete mds commands
    RUN cp /usr/lib/python2.7/site-packages/ceph_volume_client.py /usr/lib/python2.7/site-packages/ceph_volume_client.py.old
    RUN curl https://raw.githubusercontent.com/ceph/ceph/mimic/src/pybind/ceph_volume_client.py -o /usr/lib/python2.7/site-packages/ceph_volume_client.py
  magnum_api_footer: |
    RUN pip install -U --no-deps git+https://github.com/RSE-Cambridge/magnum@stable/rocky
  magnum_conductor_footer: |
    RUN pip install -U --no-deps git+https://github.com/RSE-Cambridge/magnum@stable/rocky
  keystone_footer: |
    RUN pip install -U --no-deps git+https://github.com/RSE-Cambridge/keystone@stable/rocky

# Dict mapping image customization variable names to their values.
# Each variable takes the form:
# <image name>_<customization>_<operation>
# Hyphens in the image name are replaced with underscores. The customization is
# most commonly packages. The operation should be one of override, append or
# remove. The value should be a list.
kolla_build_customizations:
  ironic_inspector_packages_append:
    # Allow custom packages to be installed via pip.
    - 'python-pip'       
  magnum_base_packages_append:
    # Allow custom packages to be installed via pip.
    - 'python-pip'
  keystone_base_packages_append:
    # Allow custom packages to be installed via pip.
    - 'python-pip'
    # Allow use of OpenID connecto for federation
    - 'mod_auth_openidc'
  neutron_server_packages_append:
    # Allow custom packages to be installed via pip.
    - 'python-pip'

###############################################################################
# Kolla-ansible inventory configuration.

# Full custom seed inventory contents.
#kolla_seed_inventory_custom:

# Custom overcloud inventory containing a mapping from top level groups to
# hosts.
#kolla_overcloud_inventory_custom_top_level:

# Custom overcloud inventory containing a mapping from components to top level
# groups.
#kolla_overcloud_inventory_custom_components:
kolla_overcloud_inventory_custom_components: "{{ lookup('template', kayobe_config_path ~ '/kolla/inventory/overcloud-components.j2') }}"

# Custom overcloud inventory containing a mapping from services to components.
#kolla_overcloud_inventory_custom_services:

# Full custom overcloud inventory contents. By default this will be the
# concatenation of the top level, component, and service inventories.
#kolla_overcloud_inventory_custom:

# Dict mapping from kolla-ansible groups to kayobe groups and variables. Each
# item is a dict with the following items:
# * groups: A list of kayobe ansible groups to map to this kolla-ansible group.
# * vars: A dict mapping variable names to values for hosts in this
#         kolla-ansible group.
#kolla_overcloud_inventory_top_level_group_map:

# List of names of top level kolla-ansible groups. Any of these groups which
# have no hosts mapped to them will be provided with an empty group definition.
#kolla_overcloud_inventory_kolla_top_level_groups:

###############################################################################
# Kolla-ansible configuration.

# Virtualenv directory where Kolla-ansible's ansible modules will execute
# remotely on the target nodes. If None, no virtualenv will be used.
#kolla_ansible_target_venv:

# Whether TLS is enabled for the external API endpoints.
kolla_enable_tls_external: True

# Whether debug logging is enabled.
#kolla_openstack_logging_debug:

# Upper constraints file for installation of Kolla.
#kolla_upper_constraints_file:

# User account to use for Kolla SSH access.
#kolla_ansible_user:

# Primary group of Kolla SSH user.
#kolla_ansible_group:

# Whether to use privilege escalation for all operations performed via Kolla
# Ansible.
#kolla_ansible_become:

###############################################################################
# Kolla feature flag configuration.

#kolla_enable_aodh:
#kolla_enable_barbican:
#kolla_enable_blazar:
#kolla_enable_cadf_notifications:
#kolla_enable_ceilometer:
kolla_enable_central_logging: True
kolla_enable_ceph: False
#kolla_enable_ceph_mds:
#kolla_enable_ceph_nfs:
#kolla_enable_ceph_rgw:
kolla_enable_cinder: True
#kolla_enable_cinder_backend_hnas_iscsi:
#kolla_enable_cinder_backend_hnas_nfs:
#kolla_enable_cinder_backend_iscsi:
#kolla_enable_cinder_backend_lvm:
#kolla_enable_cinder_backend_nfs:
#kolla_enable_cinder_backend_zfssa_iscsi:
#kolla_enable_cloudkitty:
#kolla_enable_congress:
#kolla_enable_designate:
#kolla_enable_etcd:
#kolla_enable_fluentd:
#kolla_enable_freezer:
#kolla_enable_gnocchi:
kolla_enable_grafana: True
#kolla_enable_haproxy:
kolla_enable_heat: True
kolla_enable_horizon: True
#kolla_enable_influxdb:
kolla_enable_ironic: False
#kolla_enable_ironic_ipxe:
#kolla_enable_ironic_pxe_uefi:
#kolla_enable_iscsid:
#kolla_enable_karbor:
#kolla_enable_kuryr:
kolla_enable_magnum: True
kolla_enable_manila: True
#kolla_enable_manila_backend_generic:
#kolla_enable_manila_backend_hnas:
kolla_enable_manila_backend_cephfs_native: True
kolla_enable_manila_backend_cephfs_nfs: True
#kolla_enable_mistral:
#kolla_enable_monasca:
#kolla_enable_mongodb:
#kolla_enable_multipathd:
#kolla_enable_murano:
kolla_enable_neutron_agent_ha: True
#kolla_enable_neutron_bgp_dragent:
#kolla_enable_neutron_dvr:
#kolla_enable_neutron_fwaas:
#kolla_enable_neutron_lbaas:
kolla_enable_neutron_provider_networks: True
#kolla_enable_neutron_qos:
#kolla_enable_neutron_segments:
#kolla_enable_neutron_sriov:
#kolla_enable_neutron_vpnaas:
#kolla_enable_nova_serialconsole_proxy:
#kolla_enable_octavia:
#kolla_enable_osprofiler:
#kolla_enable_panko:
kolla_enable_prometheus: True
#kolla_enable_qdrouterd:
#kolla_enable_rally:
#kolla_enable_sahara:
#kolla_enable_searchlight:
#kolla_enable_senlin:
#kolla_enable_skydive:
#kolla_enable_solum:
#kolla_enable_storm:
#kolla_enable_swift:
#kolla_enable_tacker:
#kolla_enable_telegraf:
#kolla_enable_tempest:
#kolla_enable_trove:
#kolla_enable_vitrage:
#kolla_enable_vmtp:
#kolla_enable_watcher:
#kolla_enable_zun:

###############################################################################
# Passwords and credentials.

# Dictionary containing default custom passwords to add or override in the
# Kolla passwords file.
#kolla_ansible_default_custom_passwords:

# Dictionary containing custom passwords to add or override in the Kolla
# passwords file.
#kolla_ansible_custom_passwords:

###############################################################################
# TLS certificate bundle management

# Optionally copy a TLS certificate bundle into place.
#
# When enabled, this will copy the contents of kolla_tls_cert into place for
# use by HAproxy.
#
# Note that this should be formatted as a literal style block scalar.
kolla_tls_cert: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      39316265653064623566363837343161343366356361663334623537383566353631616236376465
      3538333563656631376265336139613431386337616537300a353462356461326336326330306136
      33376636643831323737643164613462613661353233666665363931636462303562333036653566
      6531613162346135620a326563653761636465353065386339633633316439383539623162393564
      31643064356530396266663262306461366534653166643361343062653733613764323338346366
      38386533396237343732306166383761313833313538303132623061313433393538653032623130
      64303962386537613166643336346661363531613062383564633463653738653830316130623363
      31313663613361333937363231356235623361393061343739353762356530663265383463373935
      65353662363033613261303062353266303061303238633336326339623461366232376437666463
      66323136613962396338373661356632313362383536663064316635346631333464653138636536
      66323439336461653037616438303538623139643232363065323538383566613630356463663264
      39363366303338323464656637633331323263323631346466336161326166636665393362663137
      37373638336665313864633731393336383466303335636463633935306435626230653263653461
      62306637663266626263353338613864353466663931306661643234346333613031373535306462
      37386538613833623161663965653164366464303762313363646333613963623063366135373333
      65326665356238393333393766656631326261346662346363396232353330356563643732623434
      34633262343336356135393630646530333434313661363761623938366535633639393535653931
      39333866366164396332393637346464376365333964366537376366303363313766623930396535
      64613863316530386333333135616333356534616433336364623761626131623335643030616434
      66643836323837343362633839393833346138613138383634643635373838356238626665313536
      64336537613130393233613966393538616536303638643133313364343538373066633638366564
      63663534396635613532613736353266393661626665343533373734653437373232333930303233
      33383033663733303463633930616130383131663064656562313938313564643137633065363566
      35393635303739663038393563353938326666666430343138343066323861633939313566396436
      35343732323264613131373931353462666330323338316531396335613862343736333038313962
      38353136383966633335343830383432346439343564653734366262393636383366643432613763
      36316362656665393062663533306662383162626635646364633162663964313032343264316634
      65333531363262366234303263326561393730343636316634366263616565343462363663653634
      66393730343632633735623237356338343566376161613034653563653933303764636438316339
      39303038396538376232353664643639336139613938396334613537656562353632636230323764
      31356566363836303033633162333138306233616263666362613033373435353666353261656165
      31656137656361306166643236333964626134366461653336313030333339646264613630663430
      33316439393934626135306139616635343163363735363766363963363931306235303164623736
      61303363653064636131363734366661666337396430643634666139646438633066623438353761
      61333733353562306532663963643030653938626236313963663665663835623362643131303437
      66373164633330613334346234333464306662646335643531633135663562323331623563376161
      63633961373933313831323035616432373562383830616635666564643336376162346531303830
      38653330373665636363383464323432383561343036303464656564396561656239666265396234
      33373938386436353536316364376535306539386237613630323066343837336538376335376262
      37376232633637333936346431333233653439326561646238643833363033386266376236303338
      31666534303137376130343931333866393965366662396334643964323862626136373538323862
      31613137306362393362383765623738623164643232643365356131656664633965323938316263
      38326331646465336638346639376433666462373963393865663439616236643833323534643431
      32353637653432386162653432666634373961373533386435356462326166346638636335306232
      30353834393834323732363766643130346231323264366635373236316531646564633839323938
      65316137353934643332656139366263306165613839626237363835353965343265373938363136
      61623038336431313465353237353330393061373434333066396239623266376535326165343432
      31346531353232666436303462633137663266393765326661303330623334313833363531653037
      35336161623164336238343139313665623935376138376638623365653437613665356664306436
      64303862666630313731353962666164346461383464306133613231393432366265363265376435
      30323362616339636633616664393130336666656664643261633664326337383162326139633664
      35383539303330363434633137613963656430343634653666643761653264623763613136303536
      63333133333635363937316632376132303634666639623566663331366666346662656263666337
      34363061333865383238623139366664323731343466343061393830303532633366376433333733
      37383365393037343934643335396530333234353763633563633833326335366634383263323263
      65306235353062663766653363636261316635363830376533366334623038663234363666366165
      36373165383464663236663533326539623964316538333564396566333066356662613131653937
      31396630363963333734343038666531616239616462633937636337396163616431346266356438
      64633735343037623538636361663461336166383564633832363734366133336236383366343435
      35666535363235623539373164633239626139633537613066326236636563356366623435383834
      38633532373465313261326635653866636364306562346161326261343065396561336463306532
      65316637663762383332376531353961356636663266666162616632363232633337626662363335
      39643662303166353262383335626531636531366264343634346333616161623733633565363334
      33646635306465643637626565373035396630383839366465336362623939633136666664636364
      34636232316266643830643130343134376364386337343036326438626233366533393361623665
      35313436663036373033366234633931346430656662306238373736633839393134633233353531
      39393761663634313066393238396466313739643066653163643033313832643236353537353734
      37613730396136646339663262303365666339383133656338643930613839323031643031613032
      39633339336331646439343861363537623164323965663531373732653834613565373561313535
      64306361353538376634336635333735656330383461393531653233326635346464666230343834
      39363762663831393162373863656131383834346332383438353463613934643264356164313164
      35346232626165326334323738656161616462616465346161363665386537643063313937366537
      30393131346239383031663765633239356433396338343734356230623663656463323866383439
      34306233393366306238363966343032336431643031643665383738346334346466313333326131
      62346434323835396363363232396663653966633137666663636232326232656234353464663862
      39386431326535663064333936343936653163353662333234663738383739653135613965376536
      39346334313636303837393636643430336663333065336230303736643438366365393738333533
      62386362303231343362343731333364303932616166386138303933373761333037643766643038
      36373333653437333938386664326534623837363732636666333062343164613065303234656530
      31303837393032633632623231393132313861656230643961643066663563313639383639633836
      39653433623162323365386233313061353463623663326235373666366364343737666337623363
      62346333323163626561646463353832613832333037353436666432376335323135333134316633
      35373762336232313130653761643231383061383834373234653365616639636334393832666166
      33656434653036636337373731386338313631653232366666656463343166336566653336623536
      38373438313031643864396434373238373533366432666335653730326434343466306661643662
      37633265333832643834326363633363656264323030643039363137633431396239643334626530
      32616634386236353737356565356465313736656338326337343933303761336635323765353462
      38633937313930386439333731356662356237633964383439386131613136336536313363346132
      31613564343539366630366563663764363630336238643866303330393838323963623638306131
      30356662313936643763313564623966386561666364643861636137666134323732643064396534
      35376634653733346631316630333365373164343837663339363231616564636331316335313664
      66636266353266366630626633326539643530636563393136316434383335323631383566656530
      37366438633764323832353563336361346237316131303834653661366232623139636538653764
      38653032333736373237346562663833303530663563633836643933633163316335306338653162
      64313566356165303836363939623432323633353165326637306331633763393139356663363031
      61316530303262616434363739356463346530633765623330363632336561323266383532653536
      30373964626333353836653034363531396135343438663564333236623232346361383663633633
      33623964326236383433623938346362666362663563323238613865323361356635663839313632
      61383336663166343464326262656139393263613538343564663965616438613637346336653730
      32376133323238356663633437636161333636373537383831363732323061343234333137623666
      39393036306166393535646563336339333331306631396632383035303332656366396331346464
      63653033353964376133363534633763666630376236633366306330326562396532383963333032
      36653131333066656365666662366337393061633931366163663563373636613561336262336130
      63333437373664616361393239396136623737383637333564383033386462663765396632333361
      66613939653263636163666338336334653566646462313437626530336232393666613736306261
      39393138393135336237326665613935326635663633343531343162326561316432363534613063
      34633661343433333566666336303935636438653137353239653331363763383136383430323865
      35363137366339383532353938386635343864386333633465653933366633653361663433356537
      31633339333235356337373234663033623663306637373832623838323465626639636634633664
      32343261363037356162386436396466393034306666616233373431333637333533303132633530
      37393339623237623365346132353863363733343565313230326330623834383665656437373633
      30643238353065666535376561393233663063323434353162343635643531326164343030363834
      37376264626539386165643431346139633533613834653533393639663436633331663233666363
      36326539343266623134383234656562613437396634336235323361326463653238356331396333
      66356465366561643563376661346337383832643131656261333864633261303737313265623730
      38663736383637636538353139653432633163323830643232346161643137663461616132646436
      38333063306238633161333261343132343331663533306234326564653061663531373134373065
      34333661643637313764383063383532623438336237336531646335343031306433616366356331
      64353530336662316262613566636131643838633464646537643366323038643061373863353563
      65646630373566376462616364616236356333316634623237626361313532646361303330313433
      64633438653862326461306464306536613033386166383065383739363932656235633237656266
      35616436646432333331396663336330363433326232363436656265363438653565353537383434
      31643633643036383761326538396638636538643735343133313138393831623235636632363436
      64656534303230346539363032316362313164343838373665303366366563386462306530336336
      36666531386462333031613138366136666439656537303238373139323863303535303737383436
      31346266386434313862303237316132626332653835393064356237356465363031613832326632
      33616661303666316236333632346363376465323764646631633030393364306139623035633433
      34623632376336386332353964396538346139303436333530336438373764656239626635376631
      61353163316361636432303739343463313862343938373264353934346438373166313662643838
      63373834343232363462353863396466636436336239343264643536376231353732663437353836
      34353737616662623134343135616638633963653433393662323862633439383936663535353730
      32333262346331666537376462333663646330623832326262333633373635633563326162336264
      32656665613136613532386261666335316134656333313630313562613764643236396331383561
      65346337646166313062373166303731333861336330363037333735376139393839383439373064
      37356530376432626363313962363231636634653033653466326333633333326330623339366536
      63313437353731653636663136663231306135653762613930383536663631303265393634303564
      36633138386265303237316363376337663662353033363065333031623930656337363565373037
      38616164636230666565623564343965373561383734633630643138336663306633363866383937
      30633465616265346535646566616466306365396461373538366262653661393365373565306264
      38343535326534636433376566383261643264306634333465323461346630373538396632633235
      34373965336630353866643465343665643039313364323530663933666265303762613432323336
      36653362653135343465623666346137663539396537623639303239623335346536323664373262
      65363263306233333163336238373466346531653331373735643566333431303761373465346139
      64613333343430363938633733333031313036666237393838636263343039643832396162316137
      38303736323136363663646631373335646239383864343961616132343038373232363639633837
      65323565353264326537393466303037646437396530326530333232366161373731356237336164
      61356434323230656534666165323538353738303062633061623962336231366537366664666662
      65343737316635636365366665313563346630646433393138313239626562353733363439343666
      65623237653064386531306138313735343061323432383634646361653138353332

# Path to a CA certificate file to use for the OS_CACERT environment variable in
# openrc files when TLS is enabled, instead of Kolla-Ansible's default.
kolla_external_fqdn_cacert: /etc/kolla/certificates/haproxy-ca.crt

###############################################################################
# Dummy variable to allow Ansible to accept this file.
workaround_ansible_issue_8743: yes
